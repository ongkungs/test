<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Void</title>
    <style>
        :root {
            --bg: #000;
            --tile: #0a0a0a;
            --size: 35px;
        }

        body {
            margin: 0;
            background: var(--bg);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1000px;
        }

        #grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, var(--size));
            grid-template-rows: repeat(auto-fill, var(--size));
            width: 100vw;
            height: 100vh;
            gap: 1px;
        }

        .tile {
            width: 100%;
            height: 100%;
            background: var(--tile);
            border: 1px solid #151515;
            box-sizing: border-box;
            transform: scale(0);
            will-change: transform;
        }

        /* 3x3 Impact Block */
        #cube {
            position: absolute;
            width: calc(var(--size) * 3);
            height: calc(var(--size) * 3);
            border: 2px solid #fff;
            background: #000;
            z-index: 100;
            transform: translateZ(800px);
            transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1), opacity 0.4s;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="cube"></div>
    <div id="grid"></div>

    <script>
        const grid = document.getElementById('grid');
        const cube = document.getElementById('cube');
        let tiles = [];
        let isActive = false;

        function init() {
            const cols = Math.ceil(window.innerWidth / 36);
            const rows = Math.ceil(window.innerHeight / 36);
            
            for (let i = 0; i < cols * rows; i++) {
                const tile = document.createElement('div');
                tile.className = 'tile';
                grid.appendChild(tile);
                tiles.push(tile);
            }
            setTimeout(intro, 500);
        }

        function intro() {
            // Drop the block
            cube.style.transform = "translateZ(-500px) scale(0)";
            cube.style.opacity = "0";

            const cX = window.innerWidth / 2;
            const cY = window.innerHeight / 2;

            tiles.forEach(tile => {
                const r = tile.getBoundingClientRect();
                const tCenter = r.left + 17;
                const d = Math.hypot(cX - tCenter, cY - (r.top + 17));
                
                setTimeout(() => {
                    tile.style.transition = "transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), background 0.5s";
                    tile.style.transform = "translateZ(100px) scale(1.1)";
                    tile.style.background = "#333";

                    setTimeout(() => {
                        tile.style.transform = "translateZ(0) scale(1)";
                        tile.style.background = "var(--tile)";
                        
                        // Unlock hover after the ripple reaches 80% of screen
                        if (d > window.innerWidth * 0.8) isActive = true;
                    }, 600);
                }, d * 0.5);
            });
        }

        window.addEventListener('mousemove', (e) => {
            if (!isActive) return;

            // Use requestAnimationFrame for smooth performance
            window.requestAnimationFrame(() => {
                tiles.forEach(tile => {
                    const r = tile.getBoundingClientRect();
                    const d = Math.hypot(e.clientX - (r.left + 17), e.clientY - (r.top + 17));

                    if (d < 160) {
                        const p = 1 - (d / 160);
                        tile.style.transition = "transform 0.1s ease-out";
                        tile.style.transform = `translateZ(${-120 * p}px) scale(${1 - p * 0.15})`;
                        tile.style.background = `rgb(${40 * p}, ${40 * p}, ${40 * p})`;
                    } else {
                        tile.style.transition = "transform 1s ease-out, background 1s";
                        tile.style.transform = "translateZ(0) scale(1)";
                        tile.style.background = "var(--tile)";
                    }
                });
            });
        });

        init();
    </script>
</body>
</html>
